<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>BarQuest — Doc Holliday's Letter</title>
<style>
  :root{
    --bg-1:#071022;
    --bg-2:#04121b;
    --card:#081021;
    --muted:#9aa4b2;
    --accent:#ffd166;
    --gold:#e0b44a;
    --glass: rgba(255,255,255,0.03);
    --glass-2: rgba(255,255,255,0.02);
    --radius:16px;
    --maxw:520px;
  }
  html,body{height:100%;margin:0;font-family: "Times New Roman", Georgia, serif; background: linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:#eaf3ff;}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .app{
    width:94vw; max-width:var(--maxw); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.18));
    border-radius:20px;padding:18px;box-shadow:0 14px 40px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02); position:relative; overflow:hidden;
  }

  /* Header / Tabs */
  .head{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .logo{display:flex;gap:10px;align-items:center}
  .badge{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--gold),#ff9f4d);display:flex;align-items:center;justify-content:center;color:#08202a;font-weight:900;font-size:18px;box-shadow:0 6px 20px rgba(255,160,0,0.08)}
  .title{line-height:1}
  .title h1{margin:0;font-size:18px;letter-spacing:0.6px}
  .title p{margin:2px 0 0;font-size:12px;color:var(--muted);font-variant:small-caps}
  .tabs{display:flex;gap:8px}
  .tab{background:transparent;border:1px solid rgba(255,255,255,0.03);padding:8px 10px;border-radius:10px;font-weight:700;font-size:13px;cursor:pointer;color:var(--muted);transition:all .28s}
  .tab.active{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));color:var(--gold);box-shadow:0 6px 18px rgba(0,0,0,0.5);transform:translateY(-4px)}

  /* Main area */
  .main{display:grid;grid-template-rows:auto 1fr;gap:12px;margin-top:12px}
  .hero{
    display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.18));
    box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);
  }
  .hero .strap{font-size:12px;color:var(--muted);margin-bottom:8px}
  .cta{
    display:flex;align-items:center;gap:12px;
  }

  .begin{
    min-width:220px;height:64px;border-radius:999px;border:none;background:linear-gradient(180deg,var(--gold),#ffb85a);
    color:#081226;font-weight:900;font-size:18px;box-shadow:0 14px 40px rgba(0,0,0,0.45);cursor:pointer;transition:transform .55s cubic-bezier(.2,.9,.2,1), box-shadow .25s;
    -webkit-tap-highlight-color: transparent;
  }
  .begin:active{transform:translateY(-2px) scale(.996)}
  .begin.flying{transform:translateY(-160px) scale(.86) rotate(-1deg);filter:drop-shadow(0 30px 40px rgba(0,0,0,0.45))}

  /* smooth scene area */
  .viewport{position:relative;background:linear-gradient(180deg,#041726 0%, #02111b 100%);border-radius:12px;padding:12px;margin-top:8px;min-height:420px;overflow:hidden}
  .screen-wrap{display:flex;flex-direction:column;align-items:stretch;gap:12px;transition:all .45s ease}

  /* Knight area */
  .sky{position:relative;height:240px;border-radius:10px;background:
    radial-gradient(600px 160px at 10% 10%, rgba(255,255,255,0.03), transparent 6%),
    linear-gradient(180deg,#041833 0%, #021018 100%);overflow:hidden;box-shadow:inset 0 -6px 30px rgba(0,0,0,0.45)}
  .moon{position:absolute;right:18px;top:18px;width:52px;height:52px;border-radius:50%;background:linear-gradient(180deg,#fff7d6,#fff0aa);box-shadow:0 6px 30px rgba(255,200,80,0.08)}
  .stars{position:absolute;inset:0;pointer-events:none}
  .star{position:absolute;background:#fff;border-radius:50%;opacity:.9;filter:blur(.2px);animation:tw 4s infinite}
  @keyframes tw{0%{opacity:.35}50%{opacity:1}100%{opacity:.35}}

  /* The knight: more detailed SVG container */
  .knight-wrap{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);width:240px;height:240px;display:flex;align-items:flex-end;justify-content:center;pointer-events:none}
  .knight-svg{width:240px;height:240px;transform-origin:center;animation:knight-entrance 1.1s cubic-bezier(.2,.9,.2,1)}
  @keyframes knight-entrance{0%{opacity:0;transform:translateY(30px) scale(.98)}60%{opacity:1;transform:translateY(-6px) scale(1.02)}100%{transform:translateY(0) scale(1)}}

  /* shiny sweep */
  .glint{position:absolute;left:-10%;top:0;width:140%;height:100%;pointer-events:none;transform:skewX(-18deg) translateX(-100%);background:linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.12) 48%, rgba(255,255,255,0) 100%);animation:glide 2.4s linear .6s forwards}
  @keyframes glide{to{transform:skewX(-18deg) translateX(110%)}}

  /* dialog / bubble */
  .dialog{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));padding:12px;border-radius:12px;color:var(--muted);
    box-shadow:0 10px 30px rgba(0,0,0,0.5);font-size:15px;
    transition:transform .35s ease,opacity .35s;
  }
  .dialog h2{margin:0 0 6px 0;font-size:16px;color:#fff;letter-spacing:0.6px;font-variant:small-caps}
  .dialog p{margin:0 0 8px 0;line-height:1.35}

  .clip{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;color:#dff1ff;font-size:13px}

  /* navigation choices */
  .choices{display:flex;gap:8px;margin-top:10px}
  .choice{flex:1;padding:10px;border-radius:10px;text-align:center;font-weight:800;cursor:pointer;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005));color:var(--gold)}
  .choice.secondary{color:var(--muted);background:transparent; border:1px dashed rgba(255,255,255,0.03);font-weight:700}

  /* Steps and Vibes pages */
  .panel{display:none;opacity:0;transform:translateY(8px);transition:all .34s}
  .panel.on{display:block;opacity:1;transform:translateY(0)}

  .steps ul{padding-left:18px;margin:6px 0 0 0;color:var(--muted)}
  .steps li{margin:8px 0}

  .vibes{display:flex;gap:8px;flex-direction:column}
  .vibe-card{padding:12px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005));color:var(--muted);font-size:14px}

  /* footer controls */
  .controls{display:flex;align-items:center;justify-content:space-between;margin-top:10px;gap:8px}
  .music-btn{padding:8px 12px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);cursor:pointer;color:var(--muted);font-weight:700}
  .map-link{color:var(--gold);font-weight:800;text-decoration:none}

  /* old english-ish styling touches */
  .oldeng{font-family: "Times New Roman", serif; font-variant-ligatures: discretionary-ligatures; letter-spacing:.8px; text-shadow:0 1px 0 rgba(0,0,0,0.6); color:#f7f3e8}
  .ornament{font-size:12px;color:var(--muted);letter-spacing:.6px}

  @media (max-width:420px){
    .knight-wrap{width:200px;height:200px}
    .begin{min-width:180px;height:56px}
    .sky{height:200px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <main class="app" role="main" aria-live="polite">
      <div class="head">
        <div class="logo">
          <div class="badge">BQ</div>
          <div class="title">
            <h1 class="oldeng">BarQuest: Doc Holliday</h1>
            <p>Yeolde Scaventure · mobile-first</p>
          </div>
        </div>

        <div class="tabs" role="tablist" aria-label="Sections">
          <button class="tab active" data-tab="adventure" role="tab">Adventure</button>
          <button class="tab" data-tab="steps" role="tab">Steps</button>
          <button class="tab" data-tab="vibes" role="tab">Vibes</button>
        </div>
      </div>

      <div class="main">
        <section class="hero" aria-labelledby="main-hero">
          <div class="strap oldeng">Hark! Good traveler, prepare thyself</div>
          <div class="cta">
            <button id="begin" class="begin" aria-controls="viewport" aria-expanded="false">Begin Adventure</button>
            <button id="playMusic" class="music-btn" aria-pressed="false">Play Lute</button>
          </div>
        </section>

        <div id="viewport" class="viewport" tabindex="0">
          <div class="screen-wrap">

            <!-- ADVENTURE PANEL (default) -->
            <article id="adventure" class="panel on" role="article" aria-live="polite">
              <div class="sky" role="img" aria-label="Moonlit scene">
                <div class="moon" aria-hidden="true"></div>
                <div class="stars" aria-hidden="true">
                  <div class="star" style="left:8%;top:18%;width:3px;height:3px;animation-delay:.2s"></div>
                  <div class="star" style="left:26%;top:6%;width:4px;height:4px;animation-delay:.5s"></div>
                  <div class="star" style="left:52%;top:28%;width:2px;height:2px;animation-delay:1s"></div>
                  <div class="star" style="left:72%;top:12%;width:3px;height:3px;animation-delay:.8s"></div>
                </div>

                <div class="knight-wrap" aria-hidden="true">
                  <!-- More knight-like SVG: helm, visor, plume, shield, horse head silhouette -->
                  <svg class="knight-svg" viewBox="0 0 260 260" xmlns="http://www.w3.org/2000/svg" role="presentation" aria-hidden="true">
                    <defs>
                      <linearGradient id="gShield" x1="0" x2="1"><stop offset="0" stop-color="#ffd166"/><stop offset="1" stop-color="#ff8a65"/></linearGradient>
                      <linearGradient id="steel" x1="0" x2="0" y1="0" y2="1"><stop offset="0" stop-color="#eef3fb"/><stop offset="1" stop-color="#90a8cc"/></linearGradient>
                    </defs>

                    <!-- horse silhouette -->
                    <g transform="translate(20,80) scale(0.9)">
                      <path d="M160 110c-24-8-46-18-66-22-18-4-40 4-52 0-6-2-18-8-24-6-8 3-20 12-24 14-6 2-4 22 0 30 6 10 26 18 46 22 24 4 48 4 68 0 18-4 32-12 38-18 6-6 8-18 14-22 6-4 10-8 6-14-4-6-14-4-18-4z" fill="#07151a" opacity=".85"/>
                    </g>

                    <!-- knight body -->
                    <g transform="translate(40,30)">
                      <!-- shield -->
                      <path d="M62 18 L110 36 L110 88 L62 130 L14 88 L14 36 Z" fill="url(#gShield)" stroke="#fff" stroke-opacity=".08"/>
                      <!-- helmet and visor -->
                      <g transform="translate(36,10)">
                        <ellipse cx="34" cy="30" rx="34" ry="28" fill="url(#steel)" stroke="#fff" stroke-opacity=".12"/>
                        <rect x="6" y="42" width="56" height="14" rx="6" fill="#516f99"/>
                        <rect x="2" y="56" width="64" height="6" rx="3" fill="#2f486f"/>
                        <!-- visor slits -->
                        <rect x="18" y="40" width="6" height="6" rx="1" fill="#0b1220" opacity=".7"/>
                        <rect x="34" y="40" width="6" height="6" rx="1" fill="#0b1220" opacity=".7"/>
                        <rect x="50" y="40" width="6" height="6" rx="1" fill="#0b1220" opacity=".7"/>
                        <!-- plume -->
                        <path d="M10 -6 C10 -22, 40 -30, 66 -10 C50 -28, 78 -36, 90 -12" fill="none" stroke="#ff8a65" stroke-width="6" stroke-linecap="round" stroke-opacity=".9"/>
                      </g>

                      <!-- sword -->
                      <g transform="translate(122,72) rotate(-6)">
                        <rect x="0" y="0" width="6" height="64" rx="2" fill="#dfe7f6"/>
                        <rect x="-4" y="-6" width="14" height="10" rx="3" fill="#ffedc5"/>
                      </g>
                    </g>

                    <!-- subtle shine -->
                    <rect x="0" y="0" width="260" height="260" fill="transparent"/>
                  </svg>
                </div>

                <div class="glint" aria-hidden="true"></div>
              </div>

              <div class="dialog oldeng" id="dialog">
                <h2>Choose thy Quest</h2>
                <p>Hark — the parchment doth reveal a missive: <em>"Doc Holliday, it says the letter."</em> Wilt thou proceed?</p>

                <div class="clip">
                  Seek thou the shelf above the privy; there lieth a sticker inscribed <strong>"BarQuest: Round 1"</strong>. Retrieve the cipher and proceed to the next waypoint.
                </div>

                <div class="choices" style="margin-top:10px">
                  <div class="choice" id="acceptBtn">I, bold knight, accept</div>
                  <div class="choice secondary" id="laterBtn">I tarry awhile</div>
                </div>

                <div style="margin-top:10px;font-size:13px;color:var(--muted)">
                  Next waypoint: <a class="map-link" href="https://maps.google.com/?q=Coordinator+Bar" target="_blank" rel="noopener">Coordinator Bar — open map</a>
                </div>
              </div>
            </article>

            <!-- STEPS PANEL -->
            <article id="steps" class="panel" role="article" aria-hidden="true">
              <div class="dialog oldeng">
                <h2>Steps</h2>
                <p>Follow these steppe-rituals to secure thy prize.</p>
                <div class="steps">
                  <ul>
                    <li><strong>Step I.</strong> Enter the tavern and speak in courteous tone to the keeper.</li>
                    <li><strong>Step II.</strong> Seek the small shelf above the privy — the sticker shineth there.</li>
                    <li><strong>Step III.</strong> Use the cipher upon the sticker to unlock the next clue.</li>
                    <li><strong>Step IV.</strong> Proceed to the <em>Coordinator</em> in each village for confirmation.</li>
                  </ul>
                </div>
              </div>
            </article>

            <!-- VIBES PANEL -->
            <article id="vibes" class="panel" role="article" aria-hidden="true">
              <div class="dialog oldeng">
                <h2>Vibes</h2>
                <p>Ambience and runes for thy journey:</p>
                <div class="vibes">
                  <div class="vibe-card"><strong>Minstrel:</strong> gentle lute and drone — lowers haste, sharpens wit.</div>
                  <div class="vibe-card"><strong>Tavern Glow:</strong> warm lights, merriment, and hushed riddles.</div>
                  <div class="vibe-card"><strong>Knightly Oath:</strong> speak plain, be brave, leave none behind.</div>
                </div>
              </div>
            </article>

          </div>

          <div class="controls" aria-hidden="false">
            <div class="ornament">⟡ • ye olde clues • ⟡</div>
            <div>
              <a class="map-link" href="https://maps.google.com/?q=Coordinator+Bar" target="_blank" rel="noopener">Open Map</a>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

<script>
/* Smooth tab navigation */
const tabs = document.querySelectorAll('.tab');
const panels = document.querySelectorAll('.panel');
tabs.forEach(t => t.addEventListener('click', () => {
  tabs.forEach(tb => tb.classList.remove('active'));
  t.classList.add('active');
  const key = t.dataset.tab;
  panels.forEach(p => {
    if (p.id === key) {
      p.classList.add('on');
      p.removeAttribute('aria-hidden');
      p.focus && p.focus();
    } else {
      p.classList.remove('on');
      p.setAttribute('aria-hidden','true');
    }
  });
}));

/* Begin button sequence */
const begin = document.getElementById('begin');
const knightSvg = document.querySelector('.knight-svg');
const dialog = document.getElementById('dialog');
begin.addEventListener('click', async () => {
  begin.classList.add('flying');
  begin.setAttribute('aria-expanded','true');
  // quick theatrical timing
  await wait(700);
  // subtle brightness and glint replay
  const glint = document.querySelector('.glint');
  glint.style.animation = 'glide 1.8s linear forwards';
  // gentle scale on svg
  knightSvg.animate([{transform:'scale(.96) translateY(6px)'},{transform:'scale(1) translateY(0)'}],{duration:800,easing:'cubic-bezier(.2,.9,.2,1)'});
  // focus dialog after reveal
  setTimeout(()=> dialog.querySelector('h2').focus?.(), 950);
});

/* choices */
document.getElementById('acceptBtn').addEventListener('click', () => {
  const btn = document.getElementById('acceptBtn');
  btn.innerText = 'Map opening…';
  btn.style.pointerEvents = 'none';
  window.open('https://maps.google.com/?q=Coordinator+Bar', '_blank', 'noopener');
  setTimeout(()=>{ btn.innerText = 'I, bold knight, accept'; btn.style.pointerEvents = 'auto'; }, 1200);
});
document.getElementById('laterBtn').addEventListener('click', () => {
  const b = document.getElementById('laterBtn');
  b.innerText = 'I shall tarry';
  setTimeout(()=> b.innerText = 'I tarry awhile', 900);
});

/* Utility wait */
function wait(ms){ return new Promise(r => setTimeout(r, ms)); }

/* Sprinkle extra stars dynamically */
(function spritz(){
  const sky = document.querySelector('.stars');
  for(let i=0;i<8;i++){
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left = (5 + Math.random()*90) + '%';
    s.style.top = (5 + Math.random()*70) + '%';
    const size = (1 + Math.random()*3);
    s.style.width = size + 'px';
    s.style.height = size + 'px';
    s.style.animationDelay = (Math.random()*2) + 's';
    sky.appendChild(s);
  }
})();

/* Music: synthesize a medieval-ish loop with WebAudio (no external assets) */
let audioCtx = null;
let isPlaying = false;
let masterGain, droneOsc, arpTimer;

const playBtn = document.getElementById('playMusic');
playBtn.addEventListener('click', async () => {
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    masterGain = audioCtx.createGain();
    masterGain.gain.value = 0.0;
    masterGain.connect(audioCtx.destination);

    // create a soft drone (two oscillators)
    droneOsc = audioCtx.createOscillator();
    const droneOsc2 = audioCtx.createOscillator();
    const droneGain = audioCtx.createGain();
    droneGain.gain.value = 0.12;
    droneOsc.type = 'sine';
    droneOsc.frequency.value = 110; // A2-ish
    droneOsc2.type = 'triangle';
    droneOsc2.frequency.value = 55; // lower
    // gentle lowpass
    const lp = audioCtx.createBiquadFilter();
    lp.type = 'lowpass';
    lp.frequency.value = 1200;
    droneOsc.connect(droneGain);
    droneOsc2.connect(droneGain);
    droneGain.connect(lp);
    lp.connect(masterGain);

    droneOsc.start();
    droneOsc2.start();

    // arp: simple plucked notes using bufferless synth
    startArp();
    // smooth fade-in
    masterGain.gain.linearRampToValueAtTime(0.9, audioCtx.currentTime + 1.0);
  }

  if(!isPlaying){
    audioCtx.resume && audioCtx.resume();
    isPlaying = true;
    playBtn.innerText = 'Pause Lute';
    playBtn.setAttribute('aria-pressed','true');
  } else {
    // fade out
    masterGain.gain.linearRampToValueAtTime(0.0, audioCtx.currentTime + 0.6);
    setTimeout(()=> {
      audioCtx.suspend && audioCtx.suspend();
    }, 700);
    isPlaying = false;
    playBtn.innerText = 'Play Lute';
    playBtn.setAttribute('aria-pressed','false');
  }
});

/* simple arpeggiator function */
function startArp(){
  if(!audioCtx) return;
  const notes = [164.81, 196.00, 246.94, 164.81]; // E3, G3, B3, E3 - medieval-ish progression
  let idx = 0;
  arpTimer = setInterval(()=>{
    const t = audioCtx.currentTime;
    const osc = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(notes[idx % notes.length], t);
    g.gain.setValueAtTime(0.0, t);
    g.gain.linearRampToValueAtTime(0.18, t + 0.002);
    g.gain.exponentialRampToValueAtTime(0.0001, t + 1.6);
    // a bit of delay/reverb-ish effect
    const delay = audioCtx.createDelay();
    delay.delayTime.value = 0.28;
    const fb = audioCtx.createGain();
    fb.gain.value = 0.18;
    const lp = audioCtx.createBiquadFilter();
    lp.type = 'lowpass';
    lp.frequency.value = 1800;

    osc.connect(g);
    g.connect(delay);
    g.connect(lp);
    delay.connect(fb);
    fb.connect(delay);
    lp.connect(masterGain);
    delay.connect(masterGain);

    osc.start(t);
    osc.stop(t + 2.0);
    idx++;
  }, 600);
}

/* Cleanup on unload */
window.addEventListener('pagehide', ()=> {
  if(arpTimer) clearInterval(arpTimer);
  if(audioCtx) audioCtx.close && audioCtx.close();
});
</script>
</body>
</html>
